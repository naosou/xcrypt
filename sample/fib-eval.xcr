use limit;

$limit::smph=Thread::Semaphore->new(100);

%xyz = (
        'id' => 'jobfib',
        'range0' => [1,2,4,8,16],        # # of workers per node
        'range1' => [1,2,4,8], #,16],   # # of nodes
        'range2' => [43],#,44],             # fib's param
        'range3' => ["fib-lw"],#, "fib-gcc"], # implementations
        'exe' => './tcell-batch-thin',
        'cpus' => sub { $_[0]; },
        'procs' => sub { $_[1]; },
        'arg1s' => sub {"\"./$_[3] -n $_[0]\"";},
        'arg2s' => sub { $_[1]; },
        'arg3s' => sub {"\"1 $_[2]\"" },
        'arg4' => '`hostname`',
        'envfile0s' => sub { $_[3]; },
        'envfile1' => 'tcpcon',
        'envfile2' => 'tcell-batch-thin',
        # 'ofile' => 'fib-output',
        'queue' => 'gh10034',
        'option' => '# @$-g gh10034' . "\n" . '# @$-cp 00:03:00'
        );

&prepare_submit_sync (%xyz);

